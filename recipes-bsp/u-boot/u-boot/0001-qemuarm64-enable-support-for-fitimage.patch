From 77df374f8d92522b55fa175d42222bb223915512 Mon Sep 17 00:00:00 2001
From: Ricardo Salveti <ricardo@foundries.io>
Date: Thu, 14 Mar 2019 16:21:42 -0300
Subject: [PATCH] qemuarm64: enable support for fitimage

Signed-off-by: Ricardo Salveti <ricardo@foundries.io>
---
 configs/qemu_arm64_defconfig | 3 +++
 include/configs/qemu-arm.h   | 1 +
 2 files changed, 4 insertions(+)

diff --git a/configs/qemu_arm64_defconfig b/configs/qemu_arm64_defconfig
index f2e759cee9..7a4d941b80 100644
--- a/configs/qemu_arm64_defconfig
+++ b/configs/qemu_arm64_defconfig
@@ -35,3 +35,6 @@ CONFIG_USB=y
 CONFIG_DM_USB=y
 CONFIG_USB_EHCI_HCD=y
 CONFIG_USB_EHCI_PCI=y
+CONFIG_FIT=y
+CONFIG_FIT_VERBOSE=y
+CONFIG_BOOTCOMMAND="virtio scan; run distro_bootcmd"
diff --git a/include/configs/qemu-arm.h b/include/configs/qemu-arm.h
index 0431a7982d..f3adfb4fde 100644
--- a/include/configs/qemu-arm.h
+++ b/include/configs/qemu-arm.h
@@ -11,6 +11,7 @@
 /* Physical memory map */
 
 #define CONFIG_SYS_SDRAM_BASE		0x40000000
+#define CONFIG_SYS_BOOTM_LEN		SZ_32M
 
 /* The DTB generated by QEMU is placed at start of RAM, stay away from there */
 #define CONFIG_SYS_INIT_SP_ADDR         (CONFIG_SYS_SDRAM_BASE + SZ_2M)
-- 
2.17.1

